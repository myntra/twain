(function(e,t,n){typeof module!="undefined"&&module.exports?module.exports=n():typeof define=="function"&&define.amd?define(n):t[e]=n()})("Twain",this,function(){function r(t,r,i){if(t==null)return;if(e&&t.forEach===e)t.forEach(r,i);else if(t.length===+t.length){for(var s=0,o=t.length;s<o;s++)if(r.call(i,t[s],s,t)==={})return}else for(var u in t)if(n.call(t,u)&&r.call(i,t[u],u,t)==={})return}function i(e,t){var n={};return r(e,function(e,r){n[r]=typeof t=="string"?e[t]:t(e,r)}),n}function s(e){return r(t.call(arguments,1),function(t){for(var r in t)n.call(t,r)&&(e[r]=t[r])}),e}function o(e){return e!=null}function u(e){return e<0?-e:e}function a(e){return e}function l(e){if(!(this instanceof l))return new l(e);this.config=e=s({},e),r(f,function(t,n){this[n]=o(e[n])?e[n]:t},this)}function c(e){if(!(this instanceof c))return new c(e);s(this,{config:e||{},tweens:{}}),this.encode=this.config.encode||a,this.decode=this.config.decode||a,this.config.encode=this.config.decode=a}var e=[].forEach,t=[].slice,n={}.hasOwnProperty;var f={threshold:.2,multiplier:.01,now:function(){return(new Date).getTime()}};s(l.prototype,{from:function(e){return this._from=this.value=e,o(this._to)||this.to(e),this},to:function(e){return o(this._from)||this.from(e),this._to=e,this},step:function(){o(this.time)||(this.time=this.now());var e=this.now(),t=e-this.time,n=Math.min(this.multiplier*t,1),r=n*(this._to-this.value),i=this.value+r;return u(this._to-i)<this.threshold?(r=this._to-this.value,this.value=i=this._to,n=1):this.value=i,this.time=e,this._update({time:this.time,period:t,fraction:n,delta:r,value:i}),this},_update:function(){},update:function(e){return e?(this._update=e,this):this.step()},stop:function(){return this.time=null,this},multiply:function(e){this.multiplier=typeof e=="function"?e.apply(this):e}});return s(c.prototype,{$t:function(e,t){return this.tweens[e]||(this.tweens[e]=(t?c:l)(this.config))},from:function(e){var t=this.encode(e);return r(t,function(e,t){this.$t(t,typeof e=="object").from(e)},this),this},to:function(e){var t=this.encode(e);return r(t,function(e,t){this.$t(t,typeof e=="object").to(e)},this),this},step:function(){var e=this.value=i(this.tweens,function(e){return e.step().value});return this._update(e),this},decoded:function(){return this.decode(this.value)},multiply:function(e){r(this.tweens,function(t){t.multiply(e)})},_update:function(){},update:function(e){return e?(this._update=e,this):this.step()},stop:function(){return r(this.tweens,function(e){e.stop()}),this}}),c.Tween=l,c.util={isValue:o,extend:s,each:r,collect:i},c})